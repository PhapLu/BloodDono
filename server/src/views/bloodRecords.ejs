<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BloodDodo - Healthcare Blood Management Platform</title>
    <meta name="description"
        content="BloodDodo connects hospitals across Vietnam to life-saving blood donations. Real-time blood tracking, location mapping, and 24/7 availability for healthcare professionals.">
    <meta name="keywords" content="blood donation, healthcare, hospitals, Vietnam, blood bank, medical, blood tracking">
    <meta name="author" content="BloodDodo">

    <meta property="og:title" content="BloodDodo - Healthcare Blood Management Platform">
    <meta property="og:description"
        content="Connecting hospitals across Vietnam to life-saving blood donations with real-time tracking and location mapping.">
    <meta property="og:type" content="website">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@blooddodo">
    <link rel="stylesheet" href="/css/bloodRecords.css">
    <link rel="stylesheet" href="/css/partials/footer.css">
    <link rel="stylesheet" href="/css/partials/headerNav.css">
    <!-- <script defer src="all.js"></script> -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Lobster+Two:ital,wght@0,400;0,700;1,400;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
        rel="stylesheet">
</head>

<body>
    <nav class="navigation">
        <div class="nav-container">
            <div class="nav-content">
                <!-- Logo and Brand -->
                <%- include('partials/headerLogo') %>
                    <!-- Navigation Links -->
                    <%- include('partials/headerNav') %>
            </div>
        </div>
    </nav>
    <!-- Blood Records Page HTML -->
    <main class="blood-records-main">
        <div class="page-container">
            <!-- Page Header -->
            <div class="page-header">
                <h1 class="page-title">Blood Records</h1>
                <p class="page-description">Search and filter available blood inventory across healthcare facilities</p>
            </div>

            <!-- Filters Section -->
            <div class="filters-section">
                <div class="filters-container">
                    <h2 class="filters-title">Filter Results</h2>

                    <div class="filters-grid">
                        <!-- Blood Type Filter -->
                        <div class="filter-group">
                            <label class="filter-label">Blood Type</label>
                            <select class="filter-select">
                                <option value="">All Blood Types</option>
                                <option value="A+">A+</option>
                                <option value="A-">A-</option>
                                <option value="B+">B+</option>
                                <option value="B-">B-</option>
                                <option value="AB+">AB+</option>
                                <option value="AB-">AB-</option>
                                <option value="O+">O+</option>
                                <option value="O-">O-</option>
                            </select>
                        </div>

                        <!-- Location Filter -->
                        <div class="filters-section">
                            <div class="filter-group">
                                <label class="filter-label">Location</label>
                                <select class="filter-select">
                                    <option value="">All Locations</option>
                                </select>
                            </div>
                        </div>
                        <script>
                            // Populate Vietnamese provinces dropdown
                            document.addEventListener("DOMContentLoaded", () => {
                                // Populate Vietnamese provinces dropdown
                                const locationSelect = document.querySelector('.filter-select');
                                const vietnameseProvinces = [
                                    'An Giang', 'Bà Rịa - Vũng Tàu', 'Bắc Giang', 'Bắc Kạn', 'Bạc Liêu',
                                    'Bắc Ninh', 'Bến Tre', 'Bình Định', 'Bình Dương', 'Bình Phước',
                                    'Bình Thuận', 'Cà Mau', 'Cao Bằng', 'Đắk Lắk', 'Đắk Nông',
                                    'Điện Biên', 'Đồng Nai', 'Đồng Tháp', 'Gia Lai', 'Hà Giang',
                                    'Hà Nam', 'Hà Tĩnh', 'Hải Dương', 'Hậu Giang', 'Hòa Bình'
                                ];

                                if (locationSelect) {
                                    // Clear existing options except the first one (All Locations)
                                    locationSelect.innerHTML = '<option value="">All Locations</option>';

                                    // Add Vietnamese provinces
                                    vietnameseProvinces.forEach(province => {
                                        const option = document.createElement('option');
                                        option.value = province.toLowerCase().replace(/\s+/g, '-').replace(/[àáạảãâầấậẩẫăằắặẳẵ]/g, 'a')
                                            .replace(/[èéẹẻẽêềếệểễ]/g, 'e').replace(/[ìíịỉĩ]/g, 'i')
                                            .replace(/[òóọỏõôồốộổỗơờớợởỡ]/g, 'o').replace(/[ùúụủũưừứựửữ]/g, 'u')
                                            .replace(/[ỳýỵỷỹ]/g, 'y').replace(/đ/g, 'd').replace(/[^\w\s-]/g, '');
                                        option.textContent = province;
                                        locationSelect.appendChild(option);
                                    });
                                }
                            });
                        </script>

                        <!-- Availability Filter -->
                        <div class="filter-group">
                            <label class="filter-label">Availability</label>
                            <select class="filter-select">
                                <option value="">All Status</option>
                                <option value="available">Available</option>
                                <option value="low-stock">Low Stock</option>
                                <option value="out-of-stock">Out of Stock</option>
                            </select>
                        </div>

                        <!-- Blood Product Filter -->
                        <div class="filter-group">
                            <label class="filter-label">Blood Product</label>
                            <select class="filter-select">
                                <option value="">All Products</option>
                                <option value="whole-blood">Whole Blood</option>
                                <option value="red-blood-cells">Red Blood Cells</option>
                                <option value="platelets">Platelets</option>
                                <option value="plasma">Plasma</option>
                                <option value="cryoprecipitate">Cryoprecipitate</option>
                            </select>
                        </div>
                    </div>

                    <div class="filters-actions">
                        <button class="btn-primary">Apply Filters</button>
                        <button class="btn-ghost">Clear All</button>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div class="results-section">
                <div class="results-header">
                    <h2 class="results-title">Blood Inventory Results</h2>
                    <span class="results-count">Showing 6 records</span>
                </div>

                <div class="blood-records-grid">
                    <!-- Sample Blood Record Cards -->
                    <div class="blood-record-card">
                        <div class="card-header">
                            <div class="blood-type-badge type-o-positive">O+</div>
                            <div class="availability-status available">Available</div>
                        </div>
                        <div class="card-content">
                            <h3 class="hospital-name">Bach Mai Hospital</h3>
                            <p class="hospital-location">Hanoi</p>
                            <div class="blood-details">
                                <div class="detail-item">
                                    <span class="detail-label">Product:</span>
                                    <span class="detail-value">Whole Blood</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Amount:</span>
                                    <span class="detail-value">360.0 liters</span>
                                </div>
                                <div class="blood-level">
                                    <div class="blood-bar"></div>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Expiry:</span>
                                    <span class="detail-value">Dec 25, 2024</span>
                                </div>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="btn-primary btn-small">Request</button>
                            <button class="btn-ghost btn-small">Details</button>
                        </div>
                    </div>

                    <div class="blood-record-card">
                        <div class="card-header">
                            <div class="blood-type-badge type-a-negative">A-</div>
                            <div class="availability-status low-stock">Low Stock</div>
                        </div>
                        <div class="card-content">
                            <h3 class="hospital-name">Cho Ray Hospital</h3>
                            <p class="hospital-location">Ho Chi Minh City</p>
                            <div class="blood-details">
                                <div class="detail-item">
                                    <span class="detail-label">Product:</span>
                                    <span class="detail-value">Red Blood Cells</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Amount:</span>
                                    <span class="detail-value">500 milliliters</span>
                                </div>
                                <div class="blood-level">
                                    <div class="blood-bar"></div>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Expiry:</span>
                                    <span class="detail-value">Dec 20, 2024</span>
                                </div>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="btn-primary btn-small">Request</button>
                            <button class="btn-ghost btn-small">Details</button>
                        </div>
                    </div>
                    <div class="blood-record-card">
                        <div class="card-header">
                            <div class="blood-type-badge type-ab-positive">AB+</div>
                            <div class="availability-status available">Available</div>
                        </div>
                        <div class="card-content">
                            <h3 class="hospital-name">Da Nang Hospital</h3>
                            <p class="hospital-location">Da Nang</p>
                            <div class="blood-details">
                                <div class="detail-item">
                                    <span class="detail-label">Product:</span>
                                    <span class="detail-value">Platelets</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Amount:</span>
                                    <span class="detail-value">25.5 liters</span>
                                </div>
                                <div class="blood-level">
                                    <div class="blood-bar"></div>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Expiry:</span>
                                    <span class="detail-value">Dec 18, 2024</span>
                                </div>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="btn-primary btn-small">Request</button>
                            <button class="btn-ghost btn-small">Details</button>
                        </div>
                    </div>
                    <div class="blood-record-card">
                        <div class="card-header">
                            <div class="blood-type-badge type-a-positive">A+</div>
                            <div class="availability-status low-stock">Low Stock</div>
                        </div>
                        <div class="card-content">
                            <h3 class="hospital-name">Vinmec Hai Phong Hospital</h3>
                            <p class="hospital-location">Hai Phong</p>
                            <div class="blood-details">
                                <div class="detail-item">
                                    <span class="detail-label">Product:</span>
                                    <span class="detail-value">Plasma</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Amount:</span>
                                    <span class="detail-value">3 liters</span>
                                </div>
                                <div class="blood-level">
                                    <div class="blood-bar"></div>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Expiry:</span>
                                    <span class="detail-value">Sep 15, 2024</span>
                                </div>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="btn-primary btn-small">Request</button>
                            <button class="btn-ghost btn-small">Details</button>
                        </div>
                    </div>

                    <div class="blood-record-card">
                        <div class="card-header">
                            <div class="blood-type-badge type-b-positive">B+</div>
                            <div class="availability-status available">Available</div>
                        </div>
                        <div class="card-content">
                            <h3 class="hospital-name">Hue Central Hospital</h3>
                            <p class="hospital-location">Thua Thien Hue</p>
                            <div class="blood-details">
                                <div class="detail-item">
                                    <span class="detail-label">Product:</span>
                                    <span class="detail-value">Cryoprecipitate</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Amount:</span>
                                    <span class="detail-value">120 liters</span>
                                </div>
                                <div class="blood-level">
                                    <div class="blood-bar"></div>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Expiry:</span>
                                    <span class="detail-value">Jan 05, 2025</span>
                                </div>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="btn-primary btn-small">Request</button>
                            <button class="btn-ghost btn-small">Details</button>
                        </div>
                    </div>

                    <div class="blood-record-card">
                        <div class="card-header">
                            <div class="blood-type-badge type-o-negative">O-</div>
                            <div class="availability-status low-stock">Low Stock</div>
                        </div>
                        <div class="card-content">
                            <h3 class="hospital-name">Can Tho Central General Hospital</h3>
                            <p class="hospital-location">Can Tho</p>
                            <div class="blood-details">
                                <div class="detail-item">
                                    <span class="detail-label">Product:</span>
                                    <span class="detail-value">Red Blood Cells</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Amount:</span>
                                    <span class="detail-value">750 milliliters</span>
                                </div>
                                <div class="blood-level">
                                    <div class="blood-bar"></div>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Expiry:</span>
                                    <span class="detail-value">Dec 30, 2024</span>
                                </div>
                            </div>
                        </div>
                        <div class="card-actions">
                            <button class="btn-primary btn-small">Request</button>
                            <button class="btn-ghost btn-small">Details</button>
                        </div>
                    </div>
                </div>

                <!-- Pagination -->
                <div class="pagination">
                    <button class="pagination-btn" disabled>Previous</button>
                    <div class="pagination-numbers">
                        <button class="pagination-number active">1</button>
                        <button class="pagination-number">2</button>
                        <button class="pagination-number">3</button>
                    </div>
                    <button class="pagination-btn">Next</button>
                </div>
            </div>
        </div>
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const maxLiters = 1000; // Maximum capacity in liters for percentage calculation
                const cards = document.querySelectorAll(".blood-record-card");

                cards.forEach((card, index) => {
                    // Find the detail item where label contains "Amount:"
                    const detailItems = card.querySelectorAll(".detail-item");
                    let amountEl = null;

                    detailItems.forEach(item => {
                        const label = item.querySelector(".detail-label");
                        if (label && label.textContent.toLowerCase().includes("amount")) {
                            amountEl = item.querySelector(".detail-value");
                        }
                    });

                    if (!amountEl) return;

                    let amountText = amountEl.textContent.toLowerCase().trim();
                    let liters = 0;

                    // Parse the amount text to extract number and convert to liters
                    const numberMatch = amountText.match(/(\d+(?:\.\d+)?)/);
                    if (numberMatch) {
                        const number = parseFloat(numberMatch[1]);

                        if (amountText.includes("milliliter") || amountText.includes("ml")) {
                            liters = number / 1000; // Convert milliliters to liters
                        } else if (amountText.includes("liter") || amountText.includes("l")) {
                            liters = number; // Already in liters
                        }
                    }

                    // Calculate percentage (cap at 100%)
                    const percent = Math.min((liters / maxLiters) * 100, 100);
                    const bar = card.querySelector(".blood-bar");

                    if (bar) {
                        // Add staggered delay for animation effect
                        setTimeout(() => {
                            bar.style.width = percent + "%";

                            // Add a data attribute to show the actual percentage
                            bar.setAttribute('data-percentage', Math.round(percent) + '%');

                            // Optional: Add tooltip or percentage display
                            bar.title = `${liters.toFixed(1)}L (${Math.round(percent)}% of capacity)`;
                        }, 200 + (index * 100)); // Staggered animation
                    }
                });

                // Add click handlers for buttons
                const requestButtons = document.querySelectorAll('.btn-primary');
                const detailButtons = document.querySelectorAll('.btn-ghost');

                requestButtons.forEach((btn, index) => {
                    btn.addEventListener('click', () => {
                        const card = btn.closest('.blood-record-card');
                        const hospitalName = card.querySelector('.hospital-name').textContent;
                        alert(`Request submitted for ${hospitalName}`);
                    });
                });

                detailButtons.forEach((btn, index) => {
                    btn.addEventListener('click', () => {
                        const card = btn.closest('.blood-record-card');
                        const hospitalName = card.querySelector('.hospital-name').textContent;
                        const bloodType = card.querySelector('.blood-type-badge').textContent;
                        const amount = card.querySelector('.detail-item:nth-child(2) .detail-value').textContent;
                        const expiry = card.querySelector('.detail-item:last-child .detail-value').textContent;

                        alert(`Details for ${hospitalName}:\nBlood Type: ${bloodType}\nAmount: ${amount}\nExpiry: ${expiry}`);
                    });
                });
            });
        </script>
    </main>
    <!-- Footer -->
    <%- include('partials/footer.ejs') %>

        <script>
            function scrollToAbout() {
                document.getElementById('about').scrollIntoView({ behavior: 'smooth' });
            }
        </script>
        <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
        <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

</body>

</html>