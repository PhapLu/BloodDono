<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BloodDodo - Healthcare Blood Management Platform</title>
    <meta name="description"
        content="BloodDodo connects hospitals across Vietnam to life-saving blood donations. Real-time blood tracking, location mapping, and 24/7 availability for healthcare professionals.">
    <meta name="keywords" content="blood donation, healthcare, hospitals, Vietnam, blood bank, medical, blood tracking">
    <meta name="author" content="BloodDodo">

    <meta property="og:title" content="BloodDodo - Healthcare Blood Management Platform">
    <meta property="og:description"
        content="Connecting hospitals across Vietnam to life-saving blood donations with real-time tracking and location mapping.">
    <meta property="og:type" content="website">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@blooddodo">
    <link rel="stylesheet" href="/css/details.css">
    <link rel="stylesheet" href="/css/partials/footer.css">
    <link rel="stylesheet" href="/css/partials/headerNav.css">
    <!-- <script defer src="all.js"></script> -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Lobster+Two:ital,wght@0,400;0,700;1,400;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
        rel="stylesheet">
</head>

<body>
    <nav class="navigation">
        <div class="nav-container">
            <div class="nav-content">
                <!-- Logo and Brand -->
                <%- include('partials/headerLogo') %>
                    <!-- Navigation Links -->
                    <%- include('partials/headerNav') %>
            </div>
        </div>
    </nav>
    <!-- Main Content -->
    <main class="blood-detail">
       <!-- Header -->
        <section class="detail-header">
            <div>
                <h1><%= inventoryItem?.bloodType || "" %> | <%= inventoryItem?.productType || "" %></h1>
                <p class="blood-type"><%= hospital?.name %> â€¢ <%= hospital?.city %>, <%= hospital?.region %></p>
            </div>
            <div class="status <%= (inventoryItem?.status || "").toLowerCase().replace(/\s+/g, '-') %>">
                <%= inventoryItem?.status || "N/A" %>
            </div>
        </section>

        <!-- Hospital Info -->
        <section class="card">
            <h2>Hospital Information</h2>
            <ul>
                <li><strong>Name:</strong> <span><%= hospital?.name %></span></li>
                <li><strong>City:</strong> <span><%= hospital?.city %></span></li>
                <li><strong>Region:</strong> <span>Vietnam</span></li>
                <li><strong>Address:</strong> <span><%= hospital?.address || "N/A" %></span></li>
                <li><strong>Phone:</strong>
                    <% if (hospital?.contact?.phone) { %>
                        <span><a href="tel:<%= hospital.contact.phone %>" style="color: var(--primary); text-decoration: none;"><%= hospital.contact.phone %></a></span>
                    <% } else { %>
                        <span>028 7102 6789</span>
                    <% } %>
                </li>
                <!-- <li><strong>Email:</strong>
                    <% if (hospital?.contact?.email) { %>
                        <span><a href="mailto:<%= hospital.contact.email %>" style="color: var(--primary); text-decoration: none;"><%= hospital.contact.email %></a></span>
                    <% } else { %>
                        <span>N/A</span>
                    <% } %>
                </li> -->
            </ul>
        </section>

        <!-- Inventory Details -->
        <section class="card">
            <h2>Inventory Details</h2>
            <% if (inventoryItem) { %>
                <ul>
                    <li><strong>Blood Type:</strong> <span class="highlight"><%= inventoryItem.bloodType %></span></li>
                    <li><strong>Product Type:</strong> <span><%= inventoryItem.productType %></span></li>
                    <li><strong>Quantity:</strong> <span class="highlight"><%= inventoryItem.quantity %></span></li>
                    <li><strong>Unit:</strong> <span><%= inventoryItem.unit %></span></li>
                    <li><strong>Threshold Low:</strong> <span><%= inventoryItem.thresholdLow || "N/A" %></span></li>
                    <li><strong>Expiry Date:</strong> 
                        <span class="expiry-highlight"><%= inventoryItem.expiryDate ? new Date(inventoryItem.expiryDate).toISOString().split('T')[0] : "N/A" %></span>
                    </li>
                    <li><strong>Batch Number:</strong> <span><%= inventoryItem.batchNumber || "N/A" %></span></li>
                    <li><strong>Donor Source:</strong> <span><%= inventoryItem.donorSource || "N/A" %></span></li>
                    <li><strong>Status:</strong> <span><%= inventoryItem.status %></span></li>
                </ul>
            <% } else { %>
                <p>No matching inventory item found.</p>
            <% } %>
        </section>

        <!-- Blood Stock Metadata -->
        <!-- <section class="card">
            <h2>Stock Information</h2>
            <ul>
             <li><strong>Created At:</strong> <span>2024-09-15T08:00:00Z</span></li>
                <li><strong>Updated At:</strong> <span>2025-01-15T10:30:00Z</span></li>
            </ul>     <li><strong>Hospital ID:</strong> <span>64a1b2c3d4e5f6789abcdef0</span></li>
                <li><strong>Last Updated:</strong> <span>2025-01-15T10:30:00Z</span></li>
              
        </section> -->

        <!-- Emergency Contact -->
        <section class="emergency-contact">
            <h3>Emergency Blood Request</h3>
            <p>For urgent blood requests outside regular hours, call our emergency hotline: 
                <a href="tel:<%= hospital?.contact?.phone || '+8400000000' %>">
                    <%= hospital?.contact?.phone || '028 7102 6789' %>
                </a>
            </p>
        </section>

        <!-- Actions -->
        <section class="actions">
            <button type="button" class="btn-primary btn-request">Send Request</button>
            <a href="/page/bloodRecords" class="btn muted">Back to Records</a>
        </section>
    </main>
    <!-- Footer -->
    <%- include('partials/footer.ejs') %>

        <script>
            function scrollToAbout() {
                document.getElementById('about').scrollIntoView({ behavior: 'smooth' });
            }
        </script>

        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const btn = document.querySelector(".btn-request");
                if (btn) {
                    btn.addEventListener("click", () => {
                        const params = new URLSearchParams({
                            hospitalId: "<%= hospital?._id %>",
                            hospitalName: "<%= hospital?.name %>",
                            bloodType: "<%= hospital?.inventory?.[0]?.bloodType || '' %>",
                            availableAmount: "<%= hospital?.inventory?.[0]?.quantity || 0 %>"
                        });
                        window.location.href = `/page/sendRequest?${params.toString()}`;
                    });
                }
            });
        </script>
    
        <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
        <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

</body>

</html>