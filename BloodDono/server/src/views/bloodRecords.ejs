<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>BloodDodo - Healthcare Blood Management Platform</title>
        <meta
            name="description"
            content="BloodDodo connects hospitals across Vietnam to life-saving blood donations. Real-time blood tracking, location mapping, and 24/7 availability for healthcare professionals."
        />
        <meta
            name="keywords"
            content="blood donation, healthcare, hospitals, Vietnam, blood bank, medical, blood tracking"
        />
        <meta name="author" content="BloodDodo" />

        <meta
            property="og:title"
            content="BloodDodo - Healthcare Blood Management Platform"
        />
        <meta
            property="og:description"
            content="Connecting hospitals across Vietnam to life-saving blood donations with real-time tracking and location mapping."
        />
        <meta property="og:type" content="website" />

        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:site" content="@blooddodo" />
        <link rel="stylesheet" href="/css/bloodRecords.css" />
        <link rel="stylesheet" href="/css/partials/footer.css" />
        <link rel="stylesheet" href="/css/partials/headerNav.css" />
        <!-- <script defer src="all.js"></script> -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Lobster+Two:ital,wght@0,400;0,700;1,400;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
            rel="stylesheet"
        />
        <link rel="icon" type="image/png" href="/images/logo.png" />
    </head>

    <body>
        <nav class="navigation">
            <div class="nav-container">
                <div class="nav-content">
                    <!-- Logo and Brand -->
                    <%- include('partials/headerLogo') %>
                    <!-- Navigation Links -->
                    <%- include('partials/headerNav') %>
                </div>
            </div>
        </nav>
        <!-- Blood Records Page HTML -->
        <main class="blood-records-main">
            <div class="page-container">
                <!-- Page Header -->
                <div class="page-header">
                    <h1 class="page-title">Blood Records</h1>
                    <p class="page-description">
                        Search and filter available blood inventory across
                        healthcare facilities
                    </p>
                </div>

                <!-- Filters Section -->
                <div class="filters-section">
                    <!-- Filters Section -->
                    <form method="GET" action="/page/bloodRecords" class="filters-container">
                        <h2 class="filters-title">Filter Results</h2>

                        <div class="filters-grid">
                            <!-- Blood Type Filter -->
                            <div class="filter-group">
                                <label class="filter-label">Blood Type</label>
                                <select name="bloodType" class="filter-select">
                                    <option value="">All Blood Types</option>
                                    <option value="A+" <%= filters?.bloodType==="A+" ? "selected" : "" %>>A+</option>
                                    <option value="A-" <%= filters?.bloodType==="A-" ? "selected" : "" %>>A-</option>
                                    <option value="B+" <%= filters?.bloodType==="B+" ? "selected" : "" %>>B+</option>
                                    <option value="B-" <%= filters?.bloodType==="B-" ? "selected" : "" %>>B-</option>
                                    <option value="AB+" <%= filters?.bloodType==="AB+" ? "selected" : "" %>>AB+</option>
                                    <option value="AB-" <%= filters?.bloodType==="AB-" ? "selected" : "" %>>AB-</option>
                                    <option value="O+" <%= filters?.bloodType==="O+" ? "selected" : "" %>>O+</option>
                                    <option value="O-" <%= filters?.bloodType==="O-" ? "selected" : "" %>>O-</option>
                                </select>
                            </div>

                            <!-- Location Filter -->
                            <div class="filter-group">
                                <label class="filter-label">Location</label>
                                <select name="location" class="filter-select">
                                    <option value="">All Locations</option>
                                    <option value="Hà Nội" <%= filters?.location==="Hà Nội" ? "selected" : "" %>>Hà Nội</option>
                                    <option value="Hồ Chí Minh" <%= filters?.location==="Hồ Chí Minh" ? "selected" : "" %>>Hồ Chí Minh</option>
                                    <option value="Đà Nẵng" <%= filters?.location==="Đà Nẵng" ? "selected" : "" %>>Đà Nẵng</option>
                                    <option value="Hải Phòng" <%= filters?.location==="Hải Phòng" ? "selected" : "" %>>Hải Phòng</option>
                                    <option value="Cần Thơ" <%= filters?.location==="Cần Thơ" ? "selected" : "" %>>Cần Thơ</option>
                                    <option value="An Giang" <%= filters?.location==="An Giang" ? "selected" : "" %>>An Giang</option>
                                    <option value="Bà Rịa - Vũng Tàu" <%= filters?.location==="Bà Rịa - Vũng Tàu" ? "selected" : "" %>>Bà Rịa - Vũng Tàu</option>
                                    <option value="Bắc Giang" <%= filters?.location==="Bắc Giang" ? "selected" : "" %>>Bắc Giang</option>
                                    <option value="Bắc Kạn" <%= filters?.location==="Bắc Kạn" ? "selected" : "" %>>Bắc Kạn</option>
                                    <option value="Bạc Liêu" <%= filters?.location==="Bạc Liêu" ? "selected" : "" %>>Bạc Liêu</option>
                                    <option value="Bắc Ninh" <%= filters?.location==="Bắc Ninh" ? "selected" : "" %>>Bắc Ninh</option>
                                    <option value="Bến Tre" <%= filters?.location==="Bến Tre" ? "selected" : "" %>>Bến Tre</option>
                                    <option value="Bình Định" <%= filters?.location==="Bình Định" ? "selected" : "" %>>Bình Định</option>
                                    <option value="Bình Dương" <%= filters?.location==="Bình Dương" ? "selected" : "" %>>Bình Dương</option>
                                    <option value="Bình Phước" <%= filters?.location==="Bình Phước" ? "selected" : "" %>>Bình Phước</option>
                                    <option value="Bình Thuận" <%= filters?.location==="Bình Thuận" ? "selected" : "" %>>Bình Thuận</option>
                                    <option value="Cà Mau" <%= filters?.location==="Cà Mau" ? "selected" : "" %>>Cà Mau</option>
                                    <option value="Cao Bằng" <%= filters?.location==="Cao Bằng" ? "selected" : "" %>>Cao Bằng</option>
                                    <option value="Đắk Lắk" <%= filters?.location==="Đắk Lắk" ? "selected" : "" %>>Đắk Lắk</option>
                                    <option value="Đắk Nông" <%= filters?.location==="Đắk Nông" ? "selected" : "" %>>Đắk Nông</option>
                                    <option value="Điện Biên" <%= filters?.location==="Điện Biên" ? "selected" : "" %>>Điện Biên</option>
                                    <option value="Đồng Nai" <%= filters?.location==="Đồng Nai" ? "selected" : "" %>>Đồng Nai</option>
                                    <option value="Đồng Tháp" <%= filters?.location==="Đồng Tháp" ? "selected" : "" %>>Đồng Tháp</option>
                                    <option value="Gia Lai" <%= filters?.location==="Gia Lai" ? "selected" : "" %>>Gia Lai</option>
                                    <option value="Hà Giang" <%= filters?.location==="Hà Giang" ? "selected" : "" %>>Hà Giang</option>
                                    <option value="Hà Nam" <%= filters?.location==="Hà Nam" ? "selected" : "" %>>Hà Nam</option>
                                    <option value="Hà Tĩnh" <%= filters?.location==="Hà Tĩnh" ? "selected" : "" %>>Hà Tĩnh</option>
                                    <option value="Hải Dương" <%= filters?.location==="Hải Dương" ? "selected" : "" %>>Hải Dương</option>
                                    <option value="Hậu Giang" <%= filters?.location==="Hậu Giang" ? "selected" : "" %>>Hậu Giang</option>
                                    <option value="Hòa Bình" <%= filters?.location==="Hòa Bình" ? "selected" : "" %>>Hòa Bình</option>
                                    <option value="Hưng Yên" <%= filters?.location==="Hưng Yên" ? "selected" : "" %>>Hưng Yên</option>
                                    <option value="Khánh Hòa" <%= filters?.location==="Khánh Hòa" ? "selected" : "" %>>Khánh Hòa</option>
                                    <option value="Kiên Giang" <%= filters?.location==="Kiên Giang" ? "selected" : "" %>>Kiên Giang</option>
                                    <option value="Kon Tum" <%= filters?.location==="Kon Tum" ? "selected" : "" %>>Kon Tum</option>
                                    <option value="Lai Châu" <%= filters?.location==="Lai Châu" ? "selected" : "" %>>Lai Châu</option>
                                    <option value="Lâm Đồng" <%= filters?.location==="Lâm Đồng" ? "selected" : "" %>>Lâm Đồng</option>
                                    <option value="Lạng Sơn" <%= filters?.location==="Lạng Sơn" ? "selected" : "" %>>Lạng Sơn</option>
                                    <option value="Lào Cai" <%= filters?.location==="Lào Cai" ? "selected" : "" %>>Lào Cai</option>
                                    <option value="Long An" <%= filters?.location==="Long An" ? "selected" : "" %>>Long An</option>
                                    <option value="Nam Định" <%= filters?.location==="Nam Định" ? "selected" : "" %>>Nam Định</option>
                                    <option value="Nghệ An" <%= filters?.location==="Nghệ An" ? "selected" : "" %>>Nghệ An</option>
                                    <option value="Ninh Bình" <%= filters?.location==="Ninh Bình" ? "selected" : "" %>>Ninh Bình</option>
                                    <option value="Ninh Thuận" <%= filters?.location==="Ninh Thuận" ? "selected" : "" %>>Ninh Thuận</option>
                                    <option value="Phú Thọ" <%= filters?.location==="Phú Thọ" ? "selected" : "" %>>Phú Thọ</option>
                                    <option value="Quảng Bình" <%= filters?.location==="Quảng Bình" ? "selected" : "" %>>Quảng Bình</option>
                                    <option value="Quảng Nam" <%= filters?.location==="Quảng Nam" ? "selected" : "" %>>Quảng Nam</option>
                                    <option value="Quảng Ngãi" <%= filters?.location==="Quảng Ngãi" ? "selected" : "" %>>Quảng Ngãi</option>
                                    <option value="Quảng Ninh" <%= filters?.location==="Quảng Ninh" ? "selected" : "" %>>Quảng Ninh</option>
                                    <option value="Quảng Trị" <%= filters?.location==="Quảng Trị" ? "selected" : "" %>>Quảng Trị</option>
                                    <option value="Sóc Trăng" <%= filters?.location==="Sóc Trăng" ? "selected" : "" %>>Sóc Trăng</option>
                                    <option value="Sơn La" <%= filters?.location==="Sơn La" ? "selected" : "" %>>Sơn La</option>
                                    <option value="Tây Ninh" <%= filters?.location==="Tây Ninh" ? "selected" : "" %>>Tây Ninh</option>
                                    <option value="Thái Bình" <%= filters?.location==="Thái Bình" ? "selected" : "" %>>Thái Bình</option>
                                    <option value="Thái Nguyên" <%= filters?.location==="Thái Nguyên" ? "selected" : "" %>>Thái Nguyên</option>
                                    <option value="Thanh Hóa" <%= filters?.location==="Thanh Hóa" ? "selected" : "" %>>Thanh Hóa</option>
                                    <option value="Thừa Thiên Huế" <%= filters?.location==="Thừa Thiên Huế" ? "selected" : "" %>>Thừa Thiên Huế</option>
                                    <option value="Tiền Giang" <%= filters?.location==="Tiền Giang" ? "selected" : "" %>>Tiền Giang</option>
                                    <option value="Trà Vinh" <%= filters?.location==="Trà Vinh" ? "selected" : "" %>>Trà Vinh</option>
                                    <option value="Tuyên Quang" <%= filters?.location==="Tuyên Quang" ? "selected" : "" %>>Tuyên Quang</option>
                                    <option value="Vĩnh Long" <%= filters?.location==="Vĩnh Long" ? "selected" : "" %>>Vĩnh Long</option>
                                    <option value="Vĩnh Phúc" <%= filters?.location==="Vĩnh Phúc" ? "selected" : "" %>>Vĩnh Phúc</option>
                                    <option value="Yên Bái" <%= filters?.location==="Yên Bái" ? "selected" : "" %>>Yên Bái</option>
                                    <option value="Đồng Tháp" <%= filters?.location==="Đồng Tháp" ? "selected" : "" %>>Đồng Tháp</option>
                                    <option value="Bình Phước" <%= filters?.location==="Bình Phước" ? "selected" : "" %>>Bình Phước</option>
                                  </select>                                  
                            </div>

                            <!-- Availability Filter -->
                            <div class="filter-group">
                                <label class="filter-label">Availability</label>
                                <select name="status" class="filter-select">
                                    <option value="">All Status</option>
                                    <option value="Available" <%= filters?.status==="Available" ? "selected" : "" %>>Available</option>
                                    <option value="Low Stock" <%= filters?.status==="Low Stock" ? "selected" : "" %>>Low Stock</option>
                                    <option value="Out of Stock" <%= filters?.status==="Out of Stock" ? "selected" : "" %>>Out of Stock</option>
                                </select>
                            </div>

                            <!-- Blood Product Filter -->
                            <div class="filter-group">
                                <label class="filter-label">Blood Product</label>
                                <select name="productType" class="filter-select">
                                    <option value="">All Products</option>
                                    <option value="Whole Blood" <%= filters?.productType==="Whole Blood" ? "selected" : "" %>>Whole Blood</option>
                                    <option value="Red Blood Cells" <%= filters?.productType==="Red Blood Cells" ? "selected" : "" %>>Red Blood Cells</option>
                                    <option value="Platelets" <%= filters?.productType==="Platelets" ? "selected" : "" %>>Platelets</option>
                                    <option value="Plasma" <%= filters?.productType==="Plasma" ? "selected" : "" %>>Plasma</option>
                                    <option value="Cryoprecipitate" <%= filters?.productType==="Cryoprecipitate" ? "selected" : "" %>>Cryoprecipitate</option>
                                </select>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="filters-actions">
                            <button type="submit" class="btn-primary">Apply Filters</button>
                            <a href="/page/bloodRecords" class="btn-ghost">Clear All</a>
                        </div>
                    </form>
                </div>

                <!-- Results Section -->
                <div class="results-section">
                    <div class="results-header">
                        <h2 class="results-title">Blood Inventory Results</h2>
                        <!-- <span class="results-count">Showing 1421 records</span> -->
                    </div>

                    <div class="blood-records-grid">
                        <div id="loader" class="loader" style="display:none;"></div>
                        <div id="results-container">
                            <% if (Object.keys(filters || {}).length > 0 && results && results.length > 0) { %>
                                <table class="blood-records-table">
                                    <thead>
                                        <tr>
                                            <th>Blood Type & Status</th>
                                            <th>Hospital Information</th>
                                            <th>Blood Details</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% results.forEach(stock => { %>
                                        <% stock.inventory.forEach(item => { %>
                                        <tr class="blood-record-card" data-hospital-id="<%= stock.hospitalId?._id %>">
                                            <% 
                                            function bloodTypeClass(bt) {
                                                switch (bt) {
                                                case "A+": return "type-a-positive";
                                                case "A-": return "type-a-negative";
                                                case "B+": return "type-b-positive";
                                                case "B-": return "type-b-negative";
                                                case "AB+": return "type-ab-positive";
                                                case "AB-": return "type-ab-negative";
                                                case "O+": return "type-o-positive";
                                                case "O-": return "type-o-negative";
                                                default: return "";
                                                }
                                            }
                                            %>
                                            
                                            <td>
                                                <div class="card-header">
                                                    <div class="blood-type-badge <%= bloodTypeClass(item.bloodType) %>">
                                                        <%= item.bloodType %>
                                                    </div>
                                                    <div class="availability-status <%= item.status.toLowerCase() %>">
                                                        <%= item.status %>
                                                    </div>
                                                </div>
                                            </td>
                                            
                                            <td>
                                                <div class="card-content">
                                                    <h3 class="hospital-name">
                                                        <%= stock.hospitalId?.name %>
                                                    </h3>
                                                    <p class="hospital-location">
                                                        <%= stock.hospitalId?.city %>, <%=
                                                        stock.hospitalId?.region %>
                                                    </p>
                                                </div>
                                            </td>
                                            
                                            <td>
                                                <div class="blood-details">
                                                    <div class="detail-item detail-blood-type">
                                                        <span class="detail-label">Blood Type:</span>
                                                        <span class="detail-value"><%= item.bloodType %></span>
                                                    </div>
                                                    <div class="detail-item detail-amount">
                                                        <span class="detail-label ">Amount:</span>
                                                        <span class="detail-value mililiters"><%= item.quantity %> <%= item.unit %></span>
                                                    </div>
                                                    <div class="detail-item detail-expiry">
                                                        <span class="detail-label">Expiry:</span>
                                                        <span class="detail-value">
                                                            <%= item.expiryDate ? new Date(item.expiryDate).toDateString() : 'N/A' %>
                                                        </span>
                                                    </div>
                                                </div>
                                            </td>
                                            
                                            <td>
                                                <div class="card-actions">
                                                    <button type="button" class="btn-primary btn-request">Send Request</button>
                                                    <button 
                                                        type="button" 
                                                        class="btn-ghost btn-details"
                                                        data-hospital-id="<%= stock.hospitalId?._id %>"
                                                        data-blood-type="<%= item.bloodType %>"
                                                        data-product-type="<%= item.productType %>">
                                                        Details
                                                    </button>

                                                </div>
                                            </td>
                                        </tr>
                                        <% }) %>
                                        <% }) %>
                                    </tbody>
                                </table>
                            <% } else { %>
                                <p style="color: black;">No blood stock found for selected filters.</p>
                            <% } %>
                        </div>
                    </div>

                    <!-- Pagination -->
                    <div class="pagination" style="display:none;">
                        <button class="pagination-btn prev">Previous</button>
                        <div class="pagination-numbers"></div>
                        <button class="pagination-btn next">Next</button>
                    </div>                                      
                </div>
            </div>
            
        </main>
        <!-- Footer -->
        <%- include('partials/footer.ejs') %>

        <!-- External JS (recommended) -->
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const form = document.querySelector(".filters-container");
                const resultsContainer = document.getElementById("results-container");
                const loader = document.getElementById("loader");
                const pagination = document.querySelector(".pagination");
            
                let allRows = [];   // store all inventory rows (flattened)
                let currentPage = 1;
                const pageSize = 9; // ✅ only 9 rows per page
            
                form.addEventListener("submit", async (e) => {
                    e.preventDefault();
            
                    loader.style.display = "block";
                    resultsContainer.innerHTML = "";
                    pagination.style.display = "none";
            
                    const params = new URLSearchParams(new FormData(form));
                    try {
                        const res = await fetch(`/page/bloodRecords/data?${params.toString()}`);
                        const data = await res.json();
            
                        // Flatten hospital+inventory into row objects
                        allRows = [];
                        data.results?.forEach(stock => {
                            stock.inventory.forEach(item => {
                                allRows.push({ stock, item });
                            });
                        });
            
                        currentPage = 1;
                        renderPage();
                    } catch (err) {
                        resultsContainer.innerHTML = `<p style="color:red">❌ Error loading results</p>`;
                    } finally {
                        loader.style.display = "none";
                    }
                });
            
                function renderPage() {
                    if (!allRows.length) {
                        resultsContainer.innerHTML = `<p style="color:black">No blood stock found for selected filters.</p>`;
                        pagination.style.display = "none";
                        return;
                    }
            
                    const totalPages = Math.ceil(allRows.length / pageSize);
                    const start = (currentPage - 1) * pageSize;
                    const end = start + pageSize;
                    const pageRows = allRows.slice(start, end);
            
                    let html = `
                        <table class="blood-records-table">
                            <thead>
                                <tr>
                                    <th>Blood Type & Status</th>
                                    <th>Hospital Information</th>
                                    <th>Blood Details</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
            
                    pageRows.forEach(({ stock, item }) => {
                        html += `
                            <tr class="blood-record-card" data-hospital-id="${stock.hospitalId?._id}">
                                <td>
                                    <div class="card-header">
                                        <div class="blood-type-badge">${item.bloodType}</div>
                                        <div class="availability-status ${item.status.toLowerCase().replace(/\s+/g, "-")}">
                                            ${item.status}
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <div class="card-content">
                                        <h3 class="hospital-name">${stock.hospitalId?.name}</h3>
                                        <p class="hospital-location">${stock.hospitalId?.city}, ${stock.hospitalId?.region}</p>
                                    </div>
                                </td>
                                <td>
                                    <div class="blood-details">
                                        <div class="detail-item detail-blood-type">
                                            <span class="detail-label">Blood Type:</span>
                                            <span class="detail-value">${item.bloodType}</span>
                                        </div>
                                        <div class="detail-item detail-amount">
                                            <span class="detail-label">Amount:</span>
                                            <span class="detail-value mililiters">${item.quantity} ${item.unit}</span>
                                        </div>
                                        <div class="detail-item detail-expiry">
                                            <span class="detail-label">Expiry:</span>
                                            <span class="detail-value">${item.expiryDate ? new Date(item.expiryDate).toDateString() : "N/A"}</span>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <div class="card-actions">
                                        <button type="button" class="btn-primary btn-request">Send Request</button>
                                        <button 
                                        type="button" 
                                        class="btn-ghost btn-details"
                                        data-hospital-id="${stock.hospitalId?._id || stock.hospitalId}"
                                        data-blood-type="${item.bloodType}"
                                        data-product-type="${item.productType}">
                                        Details
                                        </button>
                                    </div>
                                </td>
                                </td>
                            </tr>
                        `;
                    });
            
                    html += `</tbody></table>`;
                    resultsContainer.innerHTML = html;
            
                    attachButtonHandlers();
            
                    // Show pagination if more than 1 page
                    if (totalPages > 1) {
                        renderPagination(totalPages);
                        pagination.style.display = "flex";
                    } else {
                        pagination.style.display = "none";
                    }
                }
            
                function renderPagination(totalPages) {
                    const prevBtn = pagination.querySelector(".pagination-btn.prev");
                    const nextBtn = pagination.querySelector(".pagination-btn.next");
                    const numbersDiv = pagination.querySelector(".pagination-numbers");

                    numbersDiv.innerHTML = "";

                    // how many numbers to show around current
                    const delta = 2;
                    let range = [];
                    let rangeWithDots = [];
                    let l;

                    // build visible range
                    for (let i = 1; i <= totalPages; i++) {
                        if (i === 1 || i === totalPages || (i >= currentPage - delta && i <= currentPage + delta)) {
                            range.push(i);
                        }
                    }

                    for (let i of range) {
                        if (l) {
                            if (i - l === 2) {
                                rangeWithDots.push(l + 1);
                            } else if (i - l > 2) {
                                rangeWithDots.push("...");
                            }
                        }
                        rangeWithDots.push(i);
                        l = i;
                    }

                    // render buttons
                    rangeWithDots.forEach(p => {
                        const btn = document.createElement("button");
                        if (p === "...") {
                            btn.textContent = "...";
                            btn.disabled = true;
                            btn.className = "pagination-dots";
                        } else {
                            btn.className = "pagination-number" + (p === currentPage ? " active" : "");
                            btn.textContent = p;
                            btn.addEventListener("click", () => {
                                currentPage = p;
                                renderPage();
                                window.scrollTo({ top: 570, behavior: "smooth" });
                            });
                        }
                        numbersDiv.appendChild(btn);
                    });

                    prevBtn.disabled = currentPage === 1;
                    nextBtn.disabled = currentPage === totalPages;

                    prevBtn.onclick = () => {
                        if (currentPage > 1) {
                            currentPage--;
                            renderPage();
                            window.scrollTo({ top: 570, behavior: "smooth" });
                        }
                    };

                    nextBtn.onclick = () => {
                        if (currentPage < totalPages) {
                            currentPage++;
                            renderPage();
                            window.scrollTo({ top: 570, behavior: "smooth" });
                        }
                    };
                }
            
                function attachButtonHandlers() {
                    document.querySelectorAll(".btn-request").forEach((btn) => {
                        btn.addEventListener("click", () => {
                            const card = btn.closest(".blood-record-card");
                            const hospitalId = card.getAttribute("data-hospital-id");
                            const hospitalName = card.querySelector(".hospital-name").textContent.trim();
                            const bloodType = card.querySelector(".blood-type-badge").textContent.trim();
                            const amount = card.querySelector(".detail-amount .detail-value").textContent.trim();
            
                            const params = new URLSearchParams({
                                hospitalId,
                                hospitalName,
                                bloodType,
                                availableAmount: amount.replace(/\D/g, "")
                            });
                            window.location.href = `/page/sendRequest?${params.toString()}`;
                        });
                    });
            
                    document.querySelectorAll(".btn-details").forEach((btn) => {
                        btn.addEventListener("click", () => {
                            const hospitalId = btn.dataset.hospitalId;
                            const bloodType = btn.dataset.bloodType;
                            const productType = btn.dataset.productType;

                            window.location.href = `/page/details/${hospitalId}?bloodType=${encodeURIComponent(bloodType)}&productType=${encodeURIComponent(productType)}`;
                        });
                    });
                }
            });
            </script>
                        

        <script>
            function scrollToAbout() {
                document.getElementById("about").scrollIntoView({ behavior: "smooth" });
            }
        </script>

        <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
        <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

    </body>
</html>
